# ローカルテストチェックリスト

Vercelで公開する前に、以下の項目をローカル環境でテストしてください。

## ✅ Supabase側の設定確認

### データベース
- [x] `assets`テーブルが作成されている
- [x] `asset_attachments`テーブルが作成されている
- [x] RLSポリシーが設定されている
- [x] インデックスが作成されている

### Storage
- [x] `asset-attachments`バケットが作成されている
- [x] バケットがPublicに設定されている
- [x] Storageポリシーが設定されている（アップロード・読み取り・削除・更新）

### 認証情報
- [x] Supabase URLがコード内に設定されている
- [x] Supabase Anon Keyがコード内に設定されている

## 🧪 ローカルテスト項目

### 1. アプリケーション起動
```bash
npm run dev
```
- [ ] エラーなく起動する
- [ ] `http://localhost:3000`でアクセスできる
- [ ] コンソールにエラーがない

### 2. データ読み込み
- [ ] アプリ起動時にSupabaseからデータが読み込まれる
- [ ] データが表示される（または初期データが表示される）
- [ ] ブラウザの開発者ツール（F12）でネットワークエラーがない

### 3. 資産データのCRUD操作

#### 作成（Create）
- [ ] 新しい資産を追加できる
- [ ] Supabaseの`assets`テーブルに保存される
- [ ] 画面に即座に反映される

#### 読み取り（Read）
- [ ] 資産一覧が表示される
- [ ] フィルター機能が動作する（工場・建物・フロア・ステータス）
- [ ] 検索機能が動作する
- [ ] 資産詳細を開ける

#### 更新（Update）
- [ ] 資産情報を編集できる
- [ ] 「登録する」ボタンでステータスが「確認待ち」に変わる
- [ ] Supabaseに保存される
- [ ] バリデーション（建物・フロア必須）が動作する

#### 削除（Delete）
- [ ] 資産を削除できる（実装されている場合）

### 4. ファイルアップロード機能

#### 画像ファイル
- [ ] JPEG画像をアップロードできる
- [ ] PNG画像をアップロードできる
- [ ] アップロード中に進捗表示される
- [ ] アップロード完了後にファイル名が表示される
- [ ] Supabase Storageに保存される
- [ ] データベースの`asset_attachments`テーブルに記録される

#### Excelファイル
- [ ] .xlsxファイルをアップロードできる
- [ ] .xlsファイルをアップロードできる

#### CSVファイル
- [ ] CSVファイルをアップロードできる

#### エラーハンドリング
- [ ] 10MBを超えるファイルをアップロードしようとすると警告が表示される
- [ ] 許可されていないファイル形式をアップロードしようとするとエラーが表示される
- [ ] ネットワークエラー時に適切なエラーメッセージが表示される

### 5. ファイル削除機能
- [ ] アップロードしたファイルを削除できる
- [ ] Supabase Storageからファイルが削除される
- [ ] データベースの`asset_attachments`テーブルからも削除される

### 6. CSVインポート機能
- [ ] CSVファイルをアップロードできる
- [ ] CSVデータが正しくパースされる
- [ ] 資産データとして登録される
- [ ] Supabaseに保存される

### 7. ワークフロー機能

#### 顧客側
- [ ] 資産を「登録する」でステータスが「確認待ち」に変わる
- [ ] バリデーション（建物・フロア必須）が動作する

#### ムダレス側
- [ ] 「確認待ち」の資産が表示される
- [ ] GUT評価（G/U/T）を入力できる
- [ ] 「承認する」でステータスが「承認済み」に変わる
- [ ] GUT評価必須のバリデーションが動作する
- [ ] 「差し戻す」でステータスが「差し戻し」に変わる
- [ ] コメント必須のバリデーションが動作する

### 8. ダッシュボード機能
- [ ] 進捗管理ダッシュボードが表示される
- [ ] KPIカードが正しく表示される
- [ ] チャートが表示される
- [ ] GUT評価ダッシュボードが表示される

### 9. データの永続化
- [ ] ページをリロードしてもデータが保持される
- [ ] Supabaseに保存されたデータが読み込まれる
- [ ] localStorageにフォールバックされる（Supabaseが利用できない場合）

### 10. レスポンシブデザイン
- [ ] モバイル表示で問題がない
- [ ] タブレット表示で問題がない
- [ ] デスクトップ表示で問題がない

### 11. ブラウザ互換性
- [ ] Chromeで動作する
- [ ] Safariで動作する
- [ ] Firefoxで動作する（オプション）

### 12. エラー処理
- [ ] ネットワークエラー時に適切なメッセージが表示される
- [ ] コンソールにエラーが出力されない（開発時は除く）
- [ ] ハイドレーションエラーがない

## 🔍 デバッグ方法

### ブラウザの開発者ツール
1. F12キーで開発者ツールを開く
2. 「Console」タブでエラーを確認
3. 「Network」タブでAPIリクエストを確認
4. 「Application」タブでlocalStorageを確認

### Supabaseダッシュボード
1. 「Table Editor」でデータが保存されているか確認
2. 「Storage」でファイルがアップロードされているか確認
3. 「Logs」でエラーがないか確認

## ⚠️ よくある問題と対処法

### データが表示されない
- Supabaseの接続設定を確認
- ブラウザのコンソールでエラーを確認
- Supabaseダッシュボードでテーブルにデータがあるか確認

### ファイルがアップロードできない
- StorageバケットがPublicに設定されているか確認
- Storageポリシーが正しく設定されているか確認
- ファイルサイズが10MB以下か確認

### ハイドレーションエラー
- ブラウザをハードリロード（Cmd+Shift+R / Ctrl+Shift+R）
- `.next`ディレクトリを削除して再ビルド

## 📝 テスト結果の記録

テスト完了後、以下を記録してください：
- テスト日時
- テスト環境（OS、ブラウザ）
- 発見した問題
- 修正内容

## ✅ 公開前の最終確認

すべてのテストが完了したら：
- [ ] すべてのチェック項目が完了している
- [ ] 重大なエラーがない
- [ ] 主要機能が正常に動作する
- [ ] パフォーマンスに問題がない

